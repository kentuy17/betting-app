$(function(){const d=e=>{let n=e;return[()=>n,t=>n=t]},[h,f]=d(""),[s,u]=d("");$("#done-fight").on("click",function(e){e.preventDefault(),Swal.fire({title:"RESULT:",showCancelButton:!0,showCloseButton:!1,showDenyButton:!0,allowOutsideClick:!1,confirmButtonText:"MERON",confirmButtonColor:"red",denyButtonText:"WALA",denyButtonColor:"blue",cancelButtonText:"DRAW",allowEscapeKey:!1}).then(n=>n.isConfirmed?(alert("MERON WINS"),"M"):n.isDenied?(alert("WALA WINS"),"W"):(alert("DRAW"),"D")).then(n=>{updateFightStatus(done="D",n)})}),fetch("/fight/results").then(e=>e.json()).then(e=>{for(var n=1;n<=7;n++){for(var i=$("<tr>"),c=1;c<=200;c++)i.append('<td> <div id="tdBaccaratAllConsecutive-'+n+c+'"></div></td>');i.append("</tr>"),$("#tblBaccaratResultConsecutive").append(i)}for(var t=Object.values(e),r=1,o=1,l=1;l<t.length;l++){var a=document.getElementById("tdBaccaratAllConsecutive-"+r+o);if(!a)return;t[l-1][0]=="Meron Wins"?(a.classList.add("circleRedAll"),a.innerHTML=t[l-1][1]):t[l-1][0]=="Wala Wins"?(a.classList.add("circleBlueAll"),a.innerHTML=t[l-1][1]):t[l-1][0]=="Draw"?(a.classList.add("circleGreenAll"),a.innerHTML=t[l-1][1]):(t[l-1][0]=="Cancelled"||t[l-1][0]=="Pending")&&(a.classList.add("circleCancelAll"),a.innerHTML=t[l-1][1]),l==t.length-1&&u({y:r,c:o}),t[l-1][0]==t[l][0]?r==7?(r=1,o++):r=r+1:(r=1,o++)}g(t)});function g(e){e[e.length-2][0]=="Meron Wins"&&f("M"),e[e.length-2][0]=="Wala Wins"&&f("W"),e[e.length-2][0]=="Draw"&&f("D"),e[e.length-2][0]=="Cancelled"&&f("C")}window.Echo.channel("fight").listen(".fightUpdated",async e=>{if(e.fight.prev){var i,c;h()==e.fight.prev.game_winner&&s().y!=7?(i=$(`#tdBaccaratAllConsecutive-${s().y+1}${s().c}`),c={y:s().y+1,c:s().c}):(i=$(`#tdBaccaratAllConsecutive-1${s().c+1}`),c={y:1,c:s().c+1}),i.html(e.fight.prev.fight_no),e.fight.prev.game_winner=="M"?i.addClass("circleRedAll"):e.fight.prev.game_winner=="W"?i.addClass("circleBlueAll"):e.fight.prev.game_winner=="D"?i.addClass("circleGreenAll"):i.addClass("circleCancelAll"),f(e.fight.prev.game_winner),u(c)}})});
